<?php

// connect database
function connect($sql){
    $servername = "localhost";
        $username = "root";
        $password = "";
        try {
        $conn = new PDO("mysql:host=$servername;dbname=male_fashion", $username, $password);
        // set the PDO error mode to exception
        $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        // echo "Connected successfully";
        $stmt = $conn->prepare($sql);
        $stmt->execute();
        // set the resulting array to associative
        $result = $stmt->setFetchMode(PDO::FETCH_ASSOC);
        $kq=$stmt->fetchAll();
        return $kq;
        } catch(PDOException $e) {
        echo "Connection failed: " . $e->getMessage();
        }
}



//-----------------------------------------------------------------------------Thuận---------------------------------------------------------------------------------------//

if(isset($_POST['add'])&&($_POST['add'])){
    $product = db("SELECT * FROM product where product_id = '".$_POST['index']."'")[0];
    $item = array(
        'id' => $product['product_id'],
        'name' => $product['name'],
        'img' => $product['img'],
        'price' => $product['price'],
        'sale' => $product['sale'],
        'quantity' => 1,
    );
    if (isset($_POST['qty'])&& $_POST['qty'] > 0){
        $item['quantity'] = $_POST['qty'];
    }
    // echo $item['price'] * 2;
    $flag = 0;
    if(count($_SESSION['data-cart']) > 0){
        foreach($_SESSION['data-cart'] as $x=>$product){
            if(in_array($item['id'], $_SESSION['data-cart'][$x])){
                $_SESSION['data-cart'][$x]['quantity']+=1;
                $flag = 1;
            }
        }
    }
    if ($flag ==0){
        array_push($_SESSION['data-cart'],$item);
    }
    
}



//------------------------------------------------------------------------------------------------------------------------------------------------------------------------//

//-----------------------------------------------------------------------------Tín----------------------------------------------------------------------------------------//




//------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//-----------------------------------------------------------------------------Nam----------------------------------------------------------------------------------------//





//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//-----------------------------------------------------------------------------Trầm---------------------------------------------------------------------------------------//




//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//-----------------------------------------------------------------------------Thịnh---------------------------------------------------------------------------------------//






//-------------------------------------------------------------------------------------------------------------------------------------------------------------------------//













?>